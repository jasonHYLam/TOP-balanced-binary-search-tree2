(()=>{"use strict";function t(l){if(1===l.length)return l;{const e=Math.ceil(l.length/2);let n=t(l.slice(0,e)),r=t(l.slice(e)),i=[];for(;n[0]||r[0];)n[0]<r[0]?(i.push(n[0]),n.shift()):r[0]<n[0]?(i.push(r[0]),r.shift()):n[0]==r[0]?(i.push(n[0]),i.push(r[0]),n.shift(),r.shift()):n[0]?r[0]||(i.push(n[0]),n.shift()):(i.push(r[0]),r.shift());return i}}class l{constructor(t){this.data=t,this.left=null,this.right=null}}function e(t){if(0===t.length)return null;{const n=Math.floor(t.length/2),r=new l(t[n]);return r.left=e(t.slice(0,n)),r.right=e(t.slice(n+1)),r}}const n=(t,l="",e=!0)=>{null!==t&&(null!==t.right&&n(t.right,`${l}${e?"│   ":"    "}`,!1),console.log(`${l}${e?"└── ":"┌── "}${t.data}`),null!==t.left&&n(t.left,`${l}${e?"    ":"│   "}`,!0))},r=[1,7,4,23,8,9,4,3,5,7,9,67,6345,324];console.log(r);let i=new class{constructor(l){this.root=function(l){let n=t(l);return e([...new Set(n)])}(l)}insert(t){!function t(e,n){if(n<e.data&&null==e.left){const t=new l(n);e.left=t}else if(n>e.data&&null==e.right){const t=new l(n);e.right=t}else{if(n<e.data)return t(e.left,n);if(n>e.data)return t(e.right,n);if(n==e.data)return void console.log("value already in tree, try another value")}}(this.root,t)}delete(t){!function t(l,e){if(l.left&&l.left.data===e&&null===l.left.left&&null===l.left.right)l.left=null;else if(l.right&&l.right.data===e&&null===l.right.left&&null===l.right.right)l.right=null;else if(l.left&&l.left.data===e&&null!==l.left.left&&null===l.left.left.left&&null===l.left.left.right&&null===l.left.right)l.left=l.left.left;else if(l.left&&l.left.data===e&&null!==l.left.right&&null===l.left.right.left&&null===l.left.right.right&&null===l.left.left)l.left=l.left.right;else if(l.right&&l.right.data===e&&null!==l.right.left&&null===l.right.left.left&&null===l.right.left.right&&null===l.right.right)l.right=l.right.left;else if(l.right&&l.right.data===e&&null!==l.right.right&&null===l.right.right.left&&null===l.right.right.right&&null===l.right.left)l.right=l.right.right;else if(l.data===e&&null!==l.left&&null!==l.right){let t=l.right,e=t;for(;null!==t.left;)e=t,t=t.left;l.data=t.data,e.left=null}else{if(e>l.data&&null===l.right)return void console.log(`${e} not found, please try again`);if(e<l.data&&null===l.left)return void console.log(`${e} not found, please try again`);if(e<l.data)return t(l.left,e);if(e>l.data)return t(l.right,e)}}(this.root,t)}find(t){!function t(l,e){if(l.data===e)return console.log(l),l;if(e>l.data&&null===l.right)console.log(`${e} not found`);else{if(!(e<l.data&&null===l.left))return e>l.data?t(l.right,e):e<l.data?t(l.left,e):void 0;console.log(`${e} not found`)}}(this.root,t)}levelOrderIterative(t){let l=[];for(l.push(this.root);0!==l.length;)t(l[0]),l[0].left&&l.push(l[0].left),l[0].right&&l.push(l[0].right),l.shift()}preOrder(t){if(t){function l(e){t(e),null===e.left&&null===e.right||(e.left&&l(e.left),e.right&&l(e.right))}l(this.root)}else{function e(t){let l=[t.data];return null===t.left&&null===t.right?[t.data]:(t.left&&(l=l.concat(e(t.left))),t.right&&(l=l.concat(e(t.right))),l)}console.log(e(this.root))}}inOrder(t){if(t){function l(e){null===e.left&&null===e.right?t(e):(e.left&&l(e.left),t(e),e.right&&l(e.right))}l(this.root)}else{function e(t){let l=[];return t.left&&(l=l.concat(e(t.left))),l=l.concat([t.data]),t.right&&(l=l.concat(e(t.right))),l}console.log(e(this.root))}}postOrder(t){if(t){function l(e){null===e.left&&null===e.right||(e.left&&l(e.left),e.right&&l(e.right)),t(e)}l(this.root)}else{function e(t){let l=[];return t.left&&(l=l.concat(e(t.left))),t.right&&(l=l.concat(e(t.right))),l=l.concat([t.data]),l}console.log(e(this.root))}}height(t){function l(t,e){if(t.data===e)return console.log(t),t;if(e>t.data&&null===t.right)console.log(`${e} not found`);else{if(!(e<t.data&&null===t.left))return e>t.data?l(t.right,e):e<t.data?l(t.left,e):void 0;console.log(`${e} not found`)}}const e=function t(l,e){return e=0,l.left&&(e+=t(l.left,e)+1),e}(l(this.root,t)),n=function t(l,e){return e=0,l.right&&(e+=t(l.right,e)+1),e}(l(this.root,t));return e>n?e:n>e?n:e}}(r);console.log(i),n(i.root),i.insert(9),n(i.root),i.delete(323),n(i.root),i.find(6),i.find(1),i.find(5),i.preOrder(),i.postOrder(),console.log(i.height(5))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QixRQUFRQyxJQUNKRSxFQUFRa0IsT0FBTyxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdG9wLWJhbGFuY2VkLWJpbmFyeS1zZWFyY2gtdHJlZTIvLi9zcmMvbWVyZ2VTb3J0LmpzIiwid2VicGFjazovL3RvcC1iYWxhbmNlZC1iaW5hcnktc2VhcmNoLXRyZWUyLy4vc3JjL0JTVC5qcyIsIndlYnBhY2s6Ly90b3AtYmFsYW5jZWQtYmluYXJ5LXNlYXJjaC10cmVlMi8uL3NyYy9wcmV0dHlQcmludC5qcyIsIndlYnBhY2s6Ly90b3AtYmFsYW5jZWQtYmluYXJ5LXNlYXJjaC10cmVlMi8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZnVuY3Rpb24gbWVyZ2VTb3J0KGFycmF5KSB7XG4gICAgaWYgKGFycmF5Lmxlbmd0aCA9PT0gMSkgcmV0dXJuIGFycmF5O1xuICAgIGVsc2Uge1xuICAgICAgICBjb25zdCBoYWxmID0gTWF0aC5jZWlsKGFycmF5Lmxlbmd0aC8yKVxuICAgICAgICAvLyBzcGxpdCBhcnJheSBpbiBoYWxmXG4gICAgICAgIGNvbnN0IGxlZnRIYWxmID0gYXJyYXkuc2xpY2UoMCwgaGFsZilcbiAgICAgICAgLy8gY2FsbCBtZXJnZVNvcnQgb24gdGhlIGxlZnQgaGFsZlxuICAgICAgICBsZXQgc29ydGVkTGVmdEhhbGYgPSBtZXJnZVNvcnQobGVmdEhhbGYpXG5cbiAgICAgICAgY29uc3QgcmlnaHRIYWxmID0gYXJyYXkuc2xpY2UoaGFsZilcbiAgICAgICAgLy8gY2FsbCBtZXJnZVNvcnQgb24gdGhlIHJpZ2h0IGhhbGZcbiAgICAgICAgbGV0IHNvcnRlZFJpZ2h0SGFsZiA9IG1lcmdlU29ydChyaWdodEhhbGYpO1xuXG4gICAgICAgIC8vZm9yIGVhY2ggZWxlbWVudCBpbiBsZWZ0IGhhbGYgYW5kIHJpZ2h0IGhhbGYsIHNlZSB3aGljaCBpcyBzbWFsbGVyXG4gICAgICAgIGxldCBtZXJnZWRBcnJheSA9IFtdO1xuICAgICAgICB3aGlsZSAoc29ydGVkTGVmdEhhbGZbMF0gfHwgc29ydGVkUmlnaHRIYWxmWzBdKSB7XG4gICAgICAgICAgICAvLyBpZiAoc29ydGVkTGVmdEhhbGZbMV0gPCBzb3J0ZWRSaWdodEhhbGZbMF0pIHsgaXMgdGhpcyB3cm9uZz9cbiAgICAgICAgICAgIGlmIChzb3J0ZWRMZWZ0SGFsZlswXSA8IHNvcnRlZFJpZ2h0SGFsZlswXSkge1xuICAgICAgICAgICAgICAgIG1lcmdlZEFycmF5LnB1c2goc29ydGVkTGVmdEhhbGZbMF0pXG4gICAgICAgICAgICAgICAgc29ydGVkTGVmdEhhbGYuc2hpZnQoKVxuICAgICAgICAgICAgfSBlbHNlIGlmIChzb3J0ZWRSaWdodEhhbGZbMF0gPCBzb3J0ZWRMZWZ0SGFsZlswXSkge1xuICAgICAgICAgICAgICAgIG1lcmdlZEFycmF5LnB1c2goc29ydGVkUmlnaHRIYWxmWzBdKVxuICAgICAgICAgICAgICAgIHNvcnRlZFJpZ2h0SGFsZi5zaGlmdCgpXG5cbiAgICAgICAgICAgICAgICAvLyBlZGdlIGNhc2Ugd2hlcmUgdGhlIHNhbWUgbnVtYmVyIGlzIGJlaW5nIGNvbXBhcmVkXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHNvcnRlZExlZnRIYWxmWzBdID09IHNvcnRlZFJpZ2h0SGFsZlswXSkge1xuICAgICAgICAgICAgICAgIG1lcmdlZEFycmF5LnB1c2goc29ydGVkTGVmdEhhbGZbMF0pXG4gICAgICAgICAgICAgICAgbWVyZ2VkQXJyYXkucHVzaChzb3J0ZWRSaWdodEhhbGZbMF0pXG4gICAgICAgICAgICAgICAgc29ydGVkTGVmdEhhbGYuc2hpZnQoKVxuICAgICAgICAgICAgICAgIHNvcnRlZFJpZ2h0SGFsZi5zaGlmdCgpXG4gICAgICAgICAgICAgICAgLy8gZWRnZSBjYXNlIHdoZXJlIG9uZSBhcnJheSBpcyBlbXB0eVxuICAgICAgICAgICAgfSBlbHNlIGlmICghc29ydGVkTGVmdEhhbGZbMF0pIHtcbiAgICAgICAgICAgICAgICBtZXJnZWRBcnJheS5wdXNoKHNvcnRlZFJpZ2h0SGFsZlswXSlcbiAgICAgICAgICAgICAgICBzb3J0ZWRSaWdodEhhbGYuc2hpZnQoKVxuICAgICAgICAgICAgfSBlbHNlIGlmICghc29ydGVkUmlnaHRIYWxmWzBdKSB7XG4gICAgICAgICAgICAgICAgbWVyZ2VkQXJyYXkucHVzaChzb3J0ZWRMZWZ0SGFsZlswXSlcbiAgICAgICAgICAgICAgICBzb3J0ZWRMZWZ0SGFsZi5zaGlmdCgpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIHJldHVybiBtZXJnZWRBcnJheTtcbiAgICB9XG59IiwiLy8gaW1wb3J0IHsgbm9kZSB9IGZyb20gXCJ3ZWJwYWNrXCI7XG5pbXBvcnQgeyBtZXJnZVNvcnQgfSBmcm9tIFwiLi9tZXJnZVNvcnRcIjtcblxuaW1wb3J0IHsgcHJldHR5UHJpbnQgfSBmcm9tIFwiLi9wcmV0dHlQcmludFwiO1xuXG5jbGFzcyBOb2RlIHtcbiAgICBjb25zdHJ1Y3Rvcih2YWx1ZSkge1xuICAgICAgICB0aGlzLmRhdGE9IHZhbHVlO1xuICAgICAgICB0aGlzLmxlZnQgPSBudWxsO1xuICAgICAgICB0aGlzLnJpZ2h0ID0gbnVsbDtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgVHJlZSB7XG4gICAgY29uc3RydWN0b3IoYXJyYXkpIHtcbiAgICAgICAgdGhpcy5yb290ID0gYnVpbGRUcmVlKGFycmF5KTtcbiAgICB9XG5cblxuICAgIGluc2VydCh2YWx1ZSkge1xuICAgICAgICBmdW5jdGlvbiByZWN1cnNpdmVGdW5jdGlvbihub2RlLCB2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKHZhbHVlIDwgbm9kZS5kYXRhICYmIG5vZGUubGVmdCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbmV3Tm9kZSA9IG5ldyBOb2RlKHZhbHVlKTtcbiAgICAgICAgICAgICAgICBub2RlLmxlZnQgPSBuZXdOb2RlO1xuXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlID4gbm9kZS5kYXRhICYmIG5vZGUucmlnaHQgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG5ld05vZGUgPSBuZXcgTm9kZSh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgbm9kZS5yaWdodCA9IG5ld05vZGU7XG5cbiAgICAgICAgICAgIH0gZWxzZSBpZiAodmFsdWUgPCBub2RlLmRhdGEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVjdXJzaXZlRnVuY3Rpb24obm9kZS5sZWZ0LCB2YWx1ZSlcblxuICAgICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSA+IG5vZGUuZGF0YSkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZWN1cnNpdmVGdW5jdGlvbihub2RlLnJpZ2h0LCB2YWx1ZSlcblxuICAgICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSA9PSBub2RlLmRhdGEpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInZhbHVlIGFscmVhZHkgaW4gdHJlZSwgdHJ5IGFub3RoZXIgdmFsdWVcIilcbiAgICAgICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZWN1cnNpdmVGdW5jdGlvbih0aGlzLnJvb3QsIHZhbHVlKVxuICAgIH1cblxuICAgIGRlbGV0ZSh2YWx1ZSkge1xuICAgICAgICBmdW5jdGlvbiByZWN1cnNpdmVGdW5jdGlvbihub2RlLCB2YWx1ZSkge1xuICAgICAgICAgICAgLy8gdGhpcyBjb2RlIHJlcXVpcmVzIGd1YXJkIGNsYXVzZTogaWYobm9kZS5sZWZ0KSwgb3IgaWYobm9kZS5yaWdodClcbiAgICAgICAgICAgIC8vIGNvbnNpZGVyIGF0IGxlYXN0IDQgY2FzZXNcbiAgICAgICAgICAgIC8vIENhc2UgMTogZGVsZXRpbmcgdGhlIGxlYWYgbm9kZVxuICAgICAgICAgICAgaWYgKG5vZGUubGVmdCAmJiBub2RlLmxlZnQuZGF0YSA9PT0gdmFsdWUgJiYgbm9kZS5sZWZ0LmxlZnQgPT09IG51bGwgJiYgbm9kZS5sZWZ0LnJpZ2h0ID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgbm9kZS5sZWZ0ID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKG5vZGUucmlnaHQgJiYgbm9kZS5yaWdodC5kYXRhID09PSB2YWx1ZSAmJiBub2RlLnJpZ2h0LmxlZnQgPT09IG51bGwgJiYgbm9kZS5yaWdodC5yaWdodCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIG5vZGUucmlnaHQgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gQ2FzZSAyOiBkZWxldGluZyBhIGJyYW5jaCBub2RlIHdpdGggb25lIGxlYWY7IHBvaW50IHRoZSBwcmVjZWRpbmcgY2hpbGQgdG8gdGhlIDJuZCBmb2xsb3dpbmcgY2hpbGRcbiAgICAgICAgICAgIGVsc2UgaWYgKG5vZGUubGVmdCAmJiBub2RlLmxlZnQuZGF0YSA9PT0gdmFsdWUgJiYgbm9kZS5sZWZ0LmxlZnQgIT09IG51bGwgJiYgbm9kZS5sZWZ0LmxlZnQubGVmdCA9PT0gbnVsbCBcbiAgICAgICAgICAgICAgICAmJiBub2RlLmxlZnQubGVmdC5yaWdodCA9PT0gbnVsbCAmJiBub2RlLmxlZnQucmlnaHQgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZS5sZWZ0ID0gbm9kZS5sZWZ0LmxlZnRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKG5vZGUubGVmdCAmJiBub2RlLmxlZnQuZGF0YSA9PT0gdmFsdWUgJiYgbm9kZS5sZWZ0LnJpZ2h0ICE9PSBudWxsICYmIG5vZGUubGVmdC5yaWdodC5sZWZ0ID09PSBudWxsIFxuICAgICAgICAgICAgICAgICYmIG5vZGUubGVmdC5yaWdodC5yaWdodCA9PT0gbnVsbCAmJiBub2RlLmxlZnQubGVmdCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBub2RlLmxlZnQgPSBub2RlLmxlZnQucmlnaHRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKG5vZGUucmlnaHQgJiYgbm9kZS5yaWdodC5kYXRhID09PSB2YWx1ZSAmJiBub2RlLnJpZ2h0LmxlZnQgIT09IG51bGwgJiYgbm9kZS5yaWdodC5sZWZ0LmxlZnQgPT09IG51bGwgXG4gICAgICAgICAgICAgICAgJiYgbm9kZS5yaWdodC5sZWZ0LnJpZ2h0ID09PSBudWxsICYmIG5vZGUucmlnaHQucmlnaHQgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZS5yaWdodCA9IG5vZGUucmlnaHQubGVmdFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAobm9kZS5yaWdodCAmJiBub2RlLnJpZ2h0LmRhdGEgPT09IHZhbHVlICYmIG5vZGUucmlnaHQucmlnaHQgIT09IG51bGwgJiYgbm9kZS5yaWdodC5yaWdodC5sZWZ0ID09PSBudWxsIFxuICAgICAgICAgICAgICAgICYmIG5vZGUucmlnaHQucmlnaHQucmlnaHQgPT09IG51bGwgJiYgbm9kZS5yaWdodC5sZWZ0ID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGUucmlnaHQgPSBub2RlLnJpZ2h0LnJpZ2h0XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBUT0RPOiBlZGdlIGNhc2Ugd2hlcmUgcm9vdCBpcyBoYXMgb25lIGxlYWYgKHR3byBub2RlcyBvbmx5IGluIHRoZSB0cmVlKVxuICAgICAgICAgICAgLy8gcmVxdWlyZXMgY2hlY2tpbmcgaWYgbm9kZSBpcyByb290LCBhbmQgY2hlY2tpbmcgaWYgaXQgb25seSBoYXMgb25lIGxlYWZcblxuICAgICAgICAgICAgLy8gQ2FzZSAzOiBkZWxldGluZyBhIGJyYW5jaCB3aXRoIGJvdGggbGVhdmVzOyBnZXQgdGhlIG5leHQgcmlnaHQsIHRoZW4gbGVmdG1vc3QgaSB0aGlua1xuICAgICAgICAgICAgZWxzZSBpZiAobm9kZS5kYXRhID09PSB2YWx1ZSAmJiBub2RlLmxlZnQgIT09IG51bGwgJiYgbm9kZS5yaWdodCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGxldCB0ZW1wID0gbm9kZS5yaWdodDtcbiAgICAgICAgICAgICAgICBsZXQgdGVtcFBhcmVudCA9IHRlbXA7XG4gICAgICAgICAgICAgICAgd2hpbGUgKHRlbXAubGVmdCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB0ZW1wUGFyZW50ID0gdGVtcDtcbiAgICAgICAgICAgICAgICAgICAgdGVtcCA9IHRlbXAubGVmdDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbm9kZS5kYXRhID0gdGVtcC5kYXRhO1xuICAgICAgICAgICAgICAgIHRlbXBQYXJlbnQubGVmdCA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBDYXNlIDQ6IGNvbnNvbGUgbG9nIGlmIHRoZSB2YWx1ZSBpc24ndCBmb3VuZFxuICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgPiBub2RlLmRhdGEgJiYgbm9kZS5yaWdodCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGAke3ZhbHVlfSBub3QgZm91bmQsIHBsZWFzZSB0cnkgYWdhaW5gKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh2YWx1ZSA8IG5vZGUuZGF0YSAmJiBub2RlLmxlZnQgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgJHt2YWx1ZX0gbm90IGZvdW5kLCBwbGVhc2UgdHJ5IGFnYWluYCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgPCBub2RlLmRhdGEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVjdXJzaXZlRnVuY3Rpb24obm9kZS5sZWZ0LCB2YWx1ZSlcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIHZhbHVlID4gbm9kZS5kYXRhKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlY3Vyc2l2ZUZ1bmN0aW9uKG5vZGUucmlnaHQsIHZhbHVlKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJlY3Vyc2l2ZUZ1bmN0aW9uKHRoaXMucm9vdCwgdmFsdWUpXG4gICAgfVxuXG4gICAgZmluZCh2YWx1ZSkge1xuICAgICAgICBmdW5jdGlvbiByZWN1cnNpdmVGdW5jdGlvbihub2RlLCB2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKG5vZGUuZGF0YSA9PT0gdmFsdWUpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhub2RlKVxuICAgICAgICAgICAgICAgIHJldHVybiBub2RlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlIHZhbHVlIGV4aXN0cyBhdCBsZWFmIG9yIHRoZSBsZWFmIHBhcmVudHNcbiAgICAgICAgICAgIGVsc2UgaWYgKHZhbHVlID4gbm9kZS5kYXRhICYmIG5vZGUucmlnaHQgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgJHt2YWx1ZX0gbm90IGZvdW5kYClcbiAgICAgICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHZhbHVlIDwgbm9kZS5kYXRhICYmIG5vZGUubGVmdCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGAke3ZhbHVlfSBub3QgZm91bmRgKVxuICAgICAgICAgICAgICAgIHJldHVyblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgPiBub2RlLmRhdGEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVjdXJzaXZlRnVuY3Rpb24obm9kZS5yaWdodCwgdmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgPCBub2RlLmRhdGEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVjdXJzaXZlRnVuY3Rpb24obm9kZS5sZWZ0LCB2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmVjdXJzaXZlRnVuY3Rpb24odGhpcy5yb290LCB2YWx1ZSlcbiAgICB9XG5cbiAgICBsZXZlbE9yZGVySXRlcmF0aXZlKGhlbHBlckZ1bmN0aW9uKSB7XG4gICAgICAgIGxldCBxdWV1ZSA9IFtdXG4gICAgICAgIHF1ZXVlLnB1c2godGhpcy5yb290KVxuICAgICAgICB3aGlsZSAocXVldWUubGVuZ3RoICE9PSAwKSB7XG4gICAgICAgICAgICBoZWxwZXJGdW5jdGlvbihxdWV1ZVswXSlcbiAgICAgICAgICAgIGlmIChxdWV1ZVswXS5sZWZ0KSBxdWV1ZS5wdXNoKHF1ZXVlWzBdLmxlZnQpXG4gICAgICAgICAgICBpZiAocXVldWVbMF0ucmlnaHQpIHF1ZXVlLnB1c2gocXVldWVbMF0ucmlnaHQpXG4gICAgICAgICAgICBxdWV1ZS5zaGlmdCgpXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcmVPcmRlcihoZWxwZXJGdW5jdGlvbikge1xuICAgICAgICBpZiAoaGVscGVyRnVuY3Rpb24pIHtcbiAgICAgICAgICAgIGZ1bmN0aW9uIHJlY3Vyc2l2ZUZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgICAgICAgICAgICBoZWxwZXJGdW5jdGlvbihub2RlKVxuICAgICAgICAgICAgICAgIGlmIChub2RlLmxlZnQgPT09IG51bGwgJiYgbm9kZS5yaWdodCA9PT0gbnVsbCkgcmV0dXJuXG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChub2RlLmxlZnQpIHJlY3Vyc2l2ZUZ1bmN0aW9uKG5vZGUubGVmdClcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUucmlnaHQpIHJlY3Vyc2l2ZUZ1bmN0aW9uKG5vZGUucmlnaHQpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmVjdXJzaXZlRnVuY3Rpb24odGhpcy5yb290KVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZnVuY3Rpb24gcmVjdXJzaXZlRnVuY3Rpb24obm9kZSkge1xuICAgICAgICAgICAgICAgIGxldCByZWN1cnNpdmVWYWx1ZSA9IFtub2RlLmRhdGFdO1xuICAgICAgICAgICAgICAgIGlmIChub2RlLmxlZnQgPT09IG51bGwgJiYgbm9kZS5yaWdodCA9PT0gbnVsbCkgcmV0dXJuIFtub2RlLmRhdGFdXG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChub2RlLmxlZnQpIHJlY3Vyc2l2ZVZhbHVlID0gcmVjdXJzaXZlVmFsdWUuY29uY2F0KHJlY3Vyc2l2ZUZ1bmN0aW9uKG5vZGUubGVmdCkpXG4gICAgICAgICAgICAgICAgICAgIGlmIChub2RlLnJpZ2h0KSByZWN1cnNpdmVWYWx1ZSA9IHJlY3Vyc2l2ZVZhbHVlLmNvbmNhdChyZWN1cnNpdmVGdW5jdGlvbihub2RlLnJpZ2h0KSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlY3Vyc2l2ZVZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlY3Vyc2l2ZUZ1bmN0aW9uKHRoaXMucm9vdCkpXG5cbiAgICAgICAgICAgIC8vIGNsZWFuZXIgdmVyc2lvbjsgYmFzZSBjYXNlIGlzIG5vdCBzdGF0ZWQsIGFzIGRvIG5vdCBuZWVkIHRvIHN0YXRlIGlmIG51bGxcbiAgICAgICAgICAgIC8vIGZ1bmN0aW9uIHJlY3Vyc2l2ZVRyYXZlcnNhbChub2RlKSB7XG4gICAgICAgICAgICAvLyBsZXQgYXJyYXkgPSBbbm9kZS5kYXRhXSAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gaWYgKG5vZGUubGVmdCkgYXJyYXkgPSBhcnJheS5jb25jYXQocmVjdXJzaXZlVHJhdmVyc2FsKG5vZGUubGVmdCkpIC8vIFwiY29ubmVjdGluZ1wiIGFycmF5c1xuICAgICAgICAgICAgLy8gaWYgKG5vZGUucmlnaHQpIGFycmF5ID0gYXJyYXkuY29uY2F0KHJlY3Vyc2l2ZVRyYXZlcnNhbChub2RlLnJpZ2h0KSkgLy8gXCJjb25uZWN0aW5nXCIgYXJyYXlzXG4gICAgICAgICAgICAvLyByZXR1cm4gYXJyYXlcbiAgICAgICAgICAgIC8vIH1cbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHJlY3Vyc2l2ZVRyYXZlcnNhbCh0aGlzLnJvb3QpKVxuICAgICAgICAgICAgLy8gfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gdHJhdmVyc2UgdGhlIGxlZnQgc3VidHJlZSwgdGhlbiB0aGUgcm9vdCwgdGhlbiB0aGUgcmlnaHQgc3VidHJlZS5cbiAgICBpbk9yZGVyKGhlbHBlckZ1bmN0aW9uKSB7XG4gICAgICAgIGlmIChoZWxwZXJGdW5jdGlvbikge1xuICAgICAgICAgICAgZnVuY3Rpb24gcmVjdXJzaXZlRnVuY3Rpb24obm9kZSkge1xuICAgICAgICAgICAgICAgIGlmIChub2RlLmxlZnQgPT09IG51bGwgJiYgbm9kZS5yaWdodCA9PT0gbnVsbCkgaGVscGVyRnVuY3Rpb24obm9kZSlcbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUubGVmdCkgcmVjdXJzaXZlRnVuY3Rpb24obm9kZS5sZWZ0KVxuICAgICAgICAgICAgICAgICAgICBoZWxwZXJGdW5jdGlvbihub2RlKVxuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5yaWdodCkgcmVjdXJzaXZlRnVuY3Rpb24obm9kZS5yaWdodClcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZWN1cnNpdmVGdW5jdGlvbih0aGlzLnJvb3QpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBmdW5jdGlvbiByZWN1cnNpdmVGdW5jdGlvbihub2RlKSB7XG4gICAgICAgICAgICAgICAgbGV0IHJlY3Vyc2l2ZVZhbHVlID0gW107XG4gICAgICAgICAgICAgICAgICAgIGlmIChub2RlLmxlZnQpIHJlY3Vyc2l2ZVZhbHVlID0gcmVjdXJzaXZlVmFsdWUuY29uY2F0KHJlY3Vyc2l2ZUZ1bmN0aW9uKG5vZGUubGVmdCkpXG4gICAgICAgICAgICAgICAgICAgIHJlY3Vyc2l2ZVZhbHVlID0gcmVjdXJzaXZlVmFsdWUuY29uY2F0KFtub2RlLmRhdGFdKVxuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5yaWdodCkgcmVjdXJzaXZlVmFsdWUgPSByZWN1cnNpdmVWYWx1ZS5jb25jYXQocmVjdXJzaXZlRnVuY3Rpb24obm9kZS5yaWdodCkpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZWN1cnNpdmVWYWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlY3Vyc2l2ZUZ1bmN0aW9uKHRoaXMucm9vdCkpXG4gICAgICAgIH1cbiAgICB9XG5cblxuXG4gICAgLy8gdHJhdmVyc2UgdGhlIGxlZnQgc3VidHJlZSwgdGhlbiB0aGUgcmlnaHQgc3VidHJlZSwgdGhlbiB0aGUgcm9vdC5cbiAgICBwb3N0T3JkZXIoaGVscGVyRnVuY3Rpb24pIHtcbiAgICAgICAgaWYgKGhlbHBlckZ1bmN0aW9uKSB7XG4gICAgICAgICAgICBmdW5jdGlvbiByZWN1cnNpdmVGdW5jdGlvbihub2RlKSB7XG4gICAgICAgICAgICAgICAgaWYgKG5vZGUubGVmdCA9PT0gbnVsbCAmJiBub2RlLnJpZ2h0ID09PSBudWxsKSBoZWxwZXJGdW5jdGlvbihub2RlKVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5sZWZ0KSByZWN1cnNpdmVGdW5jdGlvbihub2RlLmxlZnQpXG4gICAgICAgICAgICAgICAgICAgIGlmIChub2RlLnJpZ2h0KSByZWN1cnNpdmVGdW5jdGlvbihub2RlLnJpZ2h0KVxuICAgICAgICAgICAgICAgICAgICBoZWxwZXJGdW5jdGlvbihub2RlKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlY3Vyc2l2ZUZ1bmN0aW9uKHRoaXMucm9vdClcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGZ1bmN0aW9uIHJlY3Vyc2l2ZUZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgICAgICAgICAgICBsZXQgcmVjdXJzaXZlVmFsdWUgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUubGVmdCkgcmVjdXJzaXZlVmFsdWUgPSByZWN1cnNpdmVWYWx1ZS5jb25jYXQocmVjdXJzaXZlRnVuY3Rpb24obm9kZS5sZWZ0KSlcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUucmlnaHQpIHJlY3Vyc2l2ZVZhbHVlID0gcmVjdXJzaXZlVmFsdWUuY29uY2F0KHJlY3Vyc2l2ZUZ1bmN0aW9uKG5vZGUucmlnaHQpKVxuICAgICAgICAgICAgICAgICAgICByZWN1cnNpdmVWYWx1ZSA9IHJlY3Vyc2l2ZVZhbHVlLmNvbmNhdChbbm9kZS5kYXRhXSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlY3Vyc2l2ZVZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc29sZS5sb2cocmVjdXJzaXZlRnVuY3Rpb24odGhpcy5yb290KSlcbiAgICAgICAgfVxuICAgIH1cblxuXG4gICAgLy8gaGVpZ2h0OyBmaW5kIGxvbmdlc3QgbGVuZ3RoIGJldHdlZW4gdGhpcyBub2RlLCBhbmQgbGVhZiBub2RlLiBob3c/IGRvIGkgbmVlZCB0byB1c2UgZmluZD9cbiAgICBoZWlnaHQodmFsdWUpIHtcbiAgICAgICAgZnVuY3Rpb24gcmVjdXJzaXZlRmluZChub2RlLCB2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKG5vZGUuZGF0YSA9PT0gdmFsdWUpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhub2RlKVxuICAgICAgICAgICAgICAgIHJldHVybiBub2RlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlIHZhbHVlIGV4aXN0cyBhdCBsZWFmIG9yIHRoZSBsZWFmIHBhcmVudHNcbiAgICAgICAgICAgIGVsc2UgaWYgKHZhbHVlID4gbm9kZS5kYXRhICYmIG5vZGUucmlnaHQgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgJHt2YWx1ZX0gbm90IGZvdW5kYClcbiAgICAgICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHZhbHVlIDwgbm9kZS5kYXRhICYmIG5vZGUubGVmdCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGAke3ZhbHVlfSBub3QgZm91bmRgKVxuICAgICAgICAgICAgICAgIHJldHVyblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgPiBub2RlLmRhdGEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVjdXJzaXZlRmluZChub2RlLnJpZ2h0LCB2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh2YWx1ZSA8IG5vZGUuZGF0YSkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZWN1cnNpdmVGaW5kKG5vZGUubGVmdCwgdmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gcmVjdXJzaXZlbHkgdHJhdmVyc2UgdGhlIGxlZnQgc3VidHJlZSBhbmQgZmluZCB0aGUgaGVpZ2h0LCBcbiAgICAgICAgLy8gVEhFTiByZWN1cnNpdmVseSB0cmF2ZXJzZSB0aGUgcmlnaHQgc3VidHJlZSBhbmQgZmluZCB0aGUgaGVpZ2h0XG4gICAgICAgIC8vIHRoZW4gcmV0dXJuIHRoZSBncmVhdGVyIG9mIHRoZSB0d28gaGVpZ2h0c1xuICAgICAgICBmdW5jdGlvbiByZWN1cnNpdmVUcmF2ZXJzYWxMZWZ0KG5vZGUsIGNvdW50ZXIpIHtcbiAgICAgICAgICAgIGNvdW50ZXIgPSAwO1xuICAgICAgICAgICAgaWYgKG5vZGUubGVmdCkgY291bnRlciArPSByZWN1cnNpdmVUcmF2ZXJzYWxMZWZ0KG5vZGUubGVmdCwgY291bnRlcikrMTtcbiAgICAgICAgICAgIHJldHVybiBjb3VudGVyO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHJlY3Vyc2l2ZVRyYXZlcnNhbFJpZ2h0KG5vZGUsIGNvdW50ZXIpIHtcbiAgICAgICAgICAgIGNvdW50ZXIgPSAwO1xuICAgICAgICAgICAgaWYgKG5vZGUucmlnaHQpIGNvdW50ZXIgKz0gcmVjdXJzaXZlVHJhdmVyc2FsUmlnaHQobm9kZS5yaWdodCwgY291bnRlcikrMTtcbiAgICAgICAgICAgIHJldHVybiBjb3VudGVyO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGxlZnRDb3VudGVyID0gcmVjdXJzaXZlVHJhdmVyc2FsTGVmdChyZWN1cnNpdmVGaW5kKHRoaXMucm9vdCwgdmFsdWUpKVxuICAgICAgICBjb25zdCByaWdodENvdW50ZXIgPSByZWN1cnNpdmVUcmF2ZXJzYWxSaWdodChyZWN1cnNpdmVGaW5kKHRoaXMucm9vdCwgdmFsdWUpKVxuICAgICAgICBpZiAobGVmdENvdW50ZXIgPiByaWdodENvdW50ZXIpIHJldHVybiBsZWZ0Q291bnRlclxuICAgICAgICBlbHNlIGlmIChyaWdodENvdW50ZXIgPiBsZWZ0Q291bnRlcikgcmV0dXJuIHJpZ2h0Q291bnRlclxuICAgICAgICBlbHNlIHJldHVybiBsZWZ0Q291bnRlclxuICAgIH1cbn1cblxuXG5leHBvcnQgZnVuY3Rpb24gYnVpbGRUcmVlKGFycmF5KSB7XG4gICAgICAgIGxldCBzb3J0ZWRBcnJheSA9IG1lcmdlU29ydChhcnJheSlcbiAgICAgICAgbGV0IHJlbW92ZWREdXBsaWNhdGVzID0gWy4uLiBuZXcgU2V0KHNvcnRlZEFycmF5KV1cbiAgICAgICAgcmV0dXJuIHJlY3Vyc2l2ZUJ1aWxkVHJlZShyZW1vdmVkRHVwbGljYXRlcylcbn1cblxuZnVuY3Rpb24gcmVjdXJzaXZlQnVpbGRUcmVlKGFycmF5KSB7XG4gICAgaWYgKGFycmF5Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgICByZXR1cm4gbnVsbDsgLy8gd2hhdCBkbyBpIG5lZWQgdG8gcmV0dXJuPyBhcnJheT8gbm9kZT9cbiAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBtaWRkbGVJbmRleCA9IE1hdGguZmxvb3IoYXJyYXkubGVuZ3RoLzIpXG4gICAgICAgIGNvbnN0IHJvb3QgPSBuZXcgTm9kZShhcnJheVttaWRkbGVJbmRleF0pXG5cbiAgICAgICAgcm9vdC5sZWZ0ID0gcmVjdXJzaXZlQnVpbGRUcmVlKGFycmF5LnNsaWNlKDAsIG1pZGRsZUluZGV4KSlcbiAgICAgICAgcm9vdC5yaWdodCA9IHJlY3Vyc2l2ZUJ1aWxkVHJlZShhcnJheS5zbGljZShtaWRkbGVJbmRleCArIDEpKVxuICAgICAgICByZXR1cm4gcm9vdDtcbiAgICB9XG59XG5cbiIsImV4cG9ydCBjb25zdCBwcmV0dHlQcmludCA9IChub2RlLCBwcmVmaXggPSBcIlwiLCBpc0xlZnQgPSB0cnVlKSA9PiB7XG4gIGlmIChub2RlID09PSBudWxsKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGlmIChub2RlLnJpZ2h0ICE9PSBudWxsKSB7XG4gICAgcHJldHR5UHJpbnQobm9kZS5yaWdodCwgYCR7cHJlZml4fSR7aXNMZWZ0ID8gXCLilIIgICBcIiA6IFwiICAgIFwifWAsIGZhbHNlKTtcbiAgfVxuICBjb25zb2xlLmxvZyhgJHtwcmVmaXh9JHtpc0xlZnQgPyBcIuKUlOKUgOKUgCBcIiA6IFwi4pSM4pSA4pSAIFwifSR7bm9kZS5kYXRhfWApO1xuICBpZiAobm9kZS5sZWZ0ICE9PSBudWxsKSB7XG4gICAgcHJldHR5UHJpbnQobm9kZS5sZWZ0LCBgJHtwcmVmaXh9JHtpc0xlZnQgPyBcIiAgICBcIiA6IFwi4pSCICAgXCJ9YCwgdHJ1ZSk7XG4gIH1cbn07IiwiaW1wb3J0IHsgVHJlZSB9IGZyb20gXCIuL0JTVFwiO1xuaW1wb3J0IHsgYnVpbGRUcmVlIH0gZnJvbSBcIi4vQlNUXCI7XG5pbXBvcnQgeyBwcmV0dHlQcmludCB9IGZyb20gXCIuL3ByZXR0eVByaW50XCI7XG5cbmNvbnN0IHRlc3RBcnJheSA9IFsxLCA3LCA0LCAyMywgOCwgOSwgNCwgMywgNSwgNywgOSwgNjcsIDYzNDUsIDMyNF1cblxuY29uc29sZS5sb2codGVzdEFycmF5KVxuXG4vLyBidWlsZFRyZWUodGVzdEFycmF5KVxubGV0IG5ld1RyZWUgPSBuZXcgVHJlZSh0ZXN0QXJyYXkpXG5jb25zb2xlLmxvZyhuZXdUcmVlKVxucHJldHR5UHJpbnQobmV3VHJlZS5yb290KVxuXG5uZXdUcmVlLmluc2VydCg5KVxucHJldHR5UHJpbnQobmV3VHJlZS5yb290KVxuXG5uZXdUcmVlLmRlbGV0ZSgzMjMpXG5wcmV0dHlQcmludChuZXdUcmVlLnJvb3QpXG5cbm5ld1RyZWUuZmluZCg2KVxubmV3VHJlZS5maW5kKDEpXG5uZXdUcmVlLmZpbmQoNSlcblxuLy8gbmV3VHJlZS5sZXZlbE9yZGVySXRlcmF0aXZlKChub2RlKSA9PiBjb25zb2xlLmxvZyhub2RlKSlcblxubmV3VHJlZS5wcmVPcmRlcigpXG5cbi8vIG5ld1RyZWUucHJlT3JkZXIoKG5vZGUpPT4gY29uc29sZS5sb2cobm9kZS5kYXRhKSlcblxuLy8gbmV3VHJlZS5pbk9yZGVyKChub2RlKT0+Y29uc29sZS5sb2cobm9kZS5kYXRhKSlcblxubmV3VHJlZS5wb3N0T3JkZXIoKVxuXG5jb25zb2xlLmxvZyhcbiAgICBuZXdUcmVlLmhlaWdodCg1KVxuKSJdLCJuYW1lcyI6WyJtZXJnZVNvcnQiLCJhcnJheSIsImxlbmd0aCIsImhhbGYiLCJNYXRoIiwiY2VpbCIsInNvcnRlZExlZnRIYWxmIiwic2xpY2UiLCJzb3J0ZWRSaWdodEhhbGYiLCJtZXJnZWRBcnJheSIsInB1c2giLCJzaGlmdCIsIk5vZGUiLCJjb25zdHJ1Y3RvciIsInZhbHVlIiwidGhpcyIsImRhdGEiLCJsZWZ0IiwicmlnaHQiLCJyZWN1cnNpdmVCdWlsZFRyZWUiLCJtaWRkbGVJbmRleCIsImZsb29yIiwicm9vdCIsInByZXR0eVByaW50Iiwibm9kZSIsInByZWZpeCIsImlzTGVmdCIsImNvbnNvbGUiLCJsb2ciLCJ0ZXN0QXJyYXkiLCJuZXdUcmVlIiwic29ydGVkQXJyYXkiLCJTZXQiLCJidWlsZFRyZWUiLCJpbnNlcnQiLCJyZWN1cnNpdmVGdW5jdGlvbiIsIm5ld05vZGUiLCJ0ZW1wIiwidGVtcFBhcmVudCIsImZpbmQiLCJsZXZlbE9yZGVySXRlcmF0aXZlIiwiaGVscGVyRnVuY3Rpb24iLCJxdWV1ZSIsInByZU9yZGVyIiwicmVjdXJzaXZlVmFsdWUiLCJjb25jYXQiLCJpbk9yZGVyIiwicG9zdE9yZGVyIiwiaGVpZ2h0IiwicmVjdXJzaXZlRmluZCIsImxlZnRDb3VudGVyIiwicmVjdXJzaXZlVHJhdmVyc2FsTGVmdCIsImNvdW50ZXIiLCJyaWdodENvdW50ZXIiLCJyZWN1cnNpdmVUcmF2ZXJzYWxSaWdodCIsImRlbGV0ZSJdLCJzb3VyY2VSb290IjoiIn0=