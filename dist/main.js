(()=>{"use strict";function t(l){if(1===l.length)return l;{const e=Math.ceil(l.length/2);let r=t(l.slice(0,e)),i=t(l.slice(e)),n=[];for(;r[0]||i[0];)r[0]<i[0]?(n.push(r[0]),r.shift()):i[0]<r[0]?(n.push(i[0]),i.shift()):r[0]==i[0]?(n.push(r[0]),n.push(i[0]),r.shift(),i.shift()):r[0]?i[0]||(n.push(r[0]),r.shift()):(n.push(i[0]),i.shift());return n}}class l{constructor(t){this.data=t,this.left=null,this.right=null}}function e(t){if(0===t.length)return null;{const r=Math.floor(t.length/2),i=new l(t[r]);return i.left=e(t.slice(0,r)),i.right=e(t.slice(r+1)),i}}const r=(t,l="",e=!0)=>{null!==t&&(null!==t.right&&r(t.right,`${l}${e?"│   ":"    "}`,!1),console.log(`${l}${e?"└── ":"┌── "}${t.data}`),null!==t.left&&r(t.left,`${l}${e?"    ":"│   "}`,!0))},i=[1,7,4,23,8,9,4,3,5,7,9,67,6345,324];console.log(i);let n=new class{constructor(l){this.root=function(l){let r=t(l);return e([...new Set(r)])}(l)}insert(t){!function t(e,r){if(r<e.data&&null==e.left){const t=new l(r);e.left=t}else if(r>e.data&&null==e.right){const t=new l(r);e.right=t}else{if(r<e.data)return t(e.left,r);if(r>e.data)return t(e.right,r);if(r==e.data)return void console.log("value already in tree, try another value")}}(this.root,t)}delete(t){!function t(l,e){if(l.left&&l.left.data===e&&null===l.left.left&&null===l.left.right)l.left=null;else if(l.right&&l.right.data===e&&null===l.right.left&&null===l.right.right)l.right=null;else if(l.left&&l.left.data===e&&null!==l.left.left&&null===l.left.left.left&&null===l.left.left.right&&null===l.left.right)l.left=l.left.left;else if(l.left&&l.left.data===e&&null!==l.left.right&&null===l.left.right.left&&null===l.left.right.right&&null===l.left.left)l.left=l.left.right;else if(l.right&&l.right.data===e&&null!==l.right.left&&null===l.right.left.left&&null===l.right.left.right&&null===l.right.right)l.right=l.right.left;else if(l.right&&l.right.data===e&&null!==l.right.right&&null===l.right.right.left&&null===l.right.right.right&&null===l.right.left)l.right=l.right.right;else if(l.data===e&&null!==l.left&&null!==l.right){let t=l.right,e=t;for(;null!==t.left;)e=t,t=t.left;l.data=t.data,e.left=null}else{if(e>l.data&&null===l.right)return void console.log(`${e} not found, please try again`);if(e<l.data&&null===l.left)return void console.log(`${e} not found, please try again`);if(e<l.data)return t(l.left,e);if(e>l.data)return t(l.right,e)}}(this.root,t)}find(t){!function t(l,e){if(l.data===e)return console.log(l),l;if(e>l.data&&null===l.right)console.log(`${e} not found`);else if(e<l.data&&null===l.left)console.log(`${e} not found`);else{if(e>l.data)return t(l.right,e);if(e<l.data)return t(l.left,e)}}(this.root,t)}levelOrderIterative(t){let l=[];if(l.push(this.root),t)for(;0!==l.length;)t(l[0]),l[0].left&&l.push(l[0].left),l[0].right&&l.push(l[0].right),l.shift();else{let t=[];for(;0!==l.length;)t.push(l[0]),l[0].left&&l.push(l[0].left),l[0].right&&l.push(l[0].right),l.shift()}}preOrder(t){if(t){function l(e){t(e),null===e.left&&null===e.right||(e.left&&l(e.left),e.right&&l(e.right))}l(this.root)}else{function e(t){let l=[t.data];return null===t.left&&null===t.right?[t.data]:(t.left&&(l=l.concat(e(t.left))),t.right&&(l=l.concat(e(t.right))),l)}console.log(e(this.root))}}inOrder(t){if(t){function l(e){null===e.left&&null===e.right?t(e):(e.left&&l(e.left),t(e),e.right&&l(e.right))}l(this.root)}else{function e(t){let l=[];return t.left&&(l=l.concat(e(t.left))),l=l.concat([t.data]),t.right&&(l=l.concat(e(t.right))),l}console.log(e(this.root))}}postOrder(t){if(t){function l(e){null===e.left&&null===e.right||(e.left&&l(e.left),e.right&&l(e.right)),t(e)}l(this.root)}else{function e(t){let l=[];return t.left&&(l=l.concat(e(t.left))),t.right&&(l=l.concat(e(t.right))),l=l.concat([t.data]),l}console.log(e(this.root))}}height(t){function l(t,e){return t.data===e?t:e>t.data&&null===t.right||e<t.data&&null===t.left?void 0:e>t.data?l(t.right,e):e<t.data?l(t.left,e):void 0}const e=function t(l,e){try{return e=0,l.left&&(e+=t(l.left,e)+1),e}catch(t){return"value not found"}}(l(this.root,t)),r=function t(l,e){try{return e=0,l.right&&(e+=t(l.right,e)+1),e}catch(t){return"value not found"}}(l(this.root,t));return e>r?e:r>e?r:e}height2(t){return function t(l,e=0,r=[]){return null==l.left&&null==l.right?r.push(e):(l.left&&t(l.left,e+1,r),l.right&&t(l.right,e+1,r)),Math.max(...r)}(function t(l,e){return l.data===e?l:e>l.data&&null===l.right||e<l.data&&null===l.left?void 0:e>l.data?t(l.right,e):e<l.data?t(l.left,e):void 0}(this.root,t))}depth(t){return this.height(this.root.data)-this.height(t)}isBalanced(){const t=this.height(this.root.left.data);console.log(t);const l=this.height(this.root.right.data);console.log(l);const e=Math.abs(t-l);return console.log(e),0===e||1===e}rebalance(){}}(i);console.log(n),r(n.root),n.insert(9),r(n.root),n.delete(323),r(n.root),n.find(6),n.find(1),n.find(5),n.levelOrderIterative(),n.preOrder(),n.postOrder(),console.log(n.height2(6345)),n.insert(999),n.insert(322),n.insert(321),n.insert(320),n.insert(0),r(n.root),console.log(n.height2(324))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RixRQUFRQyxJQUFJRSxHQUNaUCxFQUFZTyxFQUFRUixNQUVwQlEsRUFBUUksT0FBTyxHQUNmWCxFQUFZTyxFQUFRUixNQUVwQlEsRUFBUXFDLE9BQU8sS0FDZjVDLEVBQVlPLEVBQVFSLE1BRXBCUSxFQUFRUyxLQUFLLEdBQ2JULEVBQVFTLEtBQUssR0FDYlQsRUFBUVMsS0FBSyxHQUliVCxFQUFRVSxzQkFDUlYsRUFBUWEsV0FNUmIsRUFBUWlCLFlBTVJwQixRQUFRQyxJQUNKRSxFQUFRMEIsUUFBUSxPQVlwQjFCLEVBQVFJLE9BQU8sS0FDZkosRUFBUUksT0FBTyxLQUNmSixFQUFRSSxPQUFPLEtBQ2ZKLEVBQVFJLE9BQU8sS0FDZkosRUFBUUksT0FBTyxHQUNmWCxFQUFZTyxFQUFRUixNQUNwQkssUUFBUUMsSUFDSkUsRUFBUTBCLFFBQVEsSyIsInNvdXJjZXMiOlsid2VicGFjazovL3RvcC1iYWxhbmNlZC1iaW5hcnktc2VhcmNoLXRyZWUyLy4vc3JjL21lcmdlU29ydC5qcyIsIndlYnBhY2s6Ly90b3AtYmFsYW5jZWQtYmluYXJ5LXNlYXJjaC10cmVlMi8uL3NyYy9CU1QuanMiLCJ3ZWJwYWNrOi8vdG9wLWJhbGFuY2VkLWJpbmFyeS1zZWFyY2gtdHJlZTIvLi9zcmMvcHJldHR5UHJpbnQuanMiLCJ3ZWJwYWNrOi8vdG9wLWJhbGFuY2VkLWJpbmFyeS1zZWFyY2gtdHJlZTIvLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGZ1bmN0aW9uIG1lcmdlU29ydChhcnJheSkge1xuICAgIGlmIChhcnJheS5sZW5ndGggPT09IDEpIHJldHVybiBhcnJheTtcbiAgICBlbHNlIHtcbiAgICAgICAgY29uc3QgaGFsZiA9IE1hdGguY2VpbChhcnJheS5sZW5ndGgvMilcbiAgICAgICAgLy8gc3BsaXQgYXJyYXkgaW4gaGFsZlxuICAgICAgICBjb25zdCBsZWZ0SGFsZiA9IGFycmF5LnNsaWNlKDAsIGhhbGYpXG4gICAgICAgIC8vIGNhbGwgbWVyZ2VTb3J0IG9uIHRoZSBsZWZ0IGhhbGZcbiAgICAgICAgbGV0IHNvcnRlZExlZnRIYWxmID0gbWVyZ2VTb3J0KGxlZnRIYWxmKVxuXG4gICAgICAgIGNvbnN0IHJpZ2h0SGFsZiA9IGFycmF5LnNsaWNlKGhhbGYpXG4gICAgICAgIC8vIGNhbGwgbWVyZ2VTb3J0IG9uIHRoZSByaWdodCBoYWxmXG4gICAgICAgIGxldCBzb3J0ZWRSaWdodEhhbGYgPSBtZXJnZVNvcnQocmlnaHRIYWxmKTtcblxuICAgICAgICAvL2ZvciBlYWNoIGVsZW1lbnQgaW4gbGVmdCBoYWxmIGFuZCByaWdodCBoYWxmLCBzZWUgd2hpY2ggaXMgc21hbGxlclxuICAgICAgICBsZXQgbWVyZ2VkQXJyYXkgPSBbXTtcbiAgICAgICAgd2hpbGUgKHNvcnRlZExlZnRIYWxmWzBdIHx8IHNvcnRlZFJpZ2h0SGFsZlswXSkge1xuICAgICAgICAgICAgLy8gaWYgKHNvcnRlZExlZnRIYWxmWzFdIDwgc29ydGVkUmlnaHRIYWxmWzBdKSB7IGlzIHRoaXMgd3Jvbmc/XG4gICAgICAgICAgICBpZiAoc29ydGVkTGVmdEhhbGZbMF0gPCBzb3J0ZWRSaWdodEhhbGZbMF0pIHtcbiAgICAgICAgICAgICAgICBtZXJnZWRBcnJheS5wdXNoKHNvcnRlZExlZnRIYWxmWzBdKVxuICAgICAgICAgICAgICAgIHNvcnRlZExlZnRIYWxmLnNoaWZ0KClcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc29ydGVkUmlnaHRIYWxmWzBdIDwgc29ydGVkTGVmdEhhbGZbMF0pIHtcbiAgICAgICAgICAgICAgICBtZXJnZWRBcnJheS5wdXNoKHNvcnRlZFJpZ2h0SGFsZlswXSlcbiAgICAgICAgICAgICAgICBzb3J0ZWRSaWdodEhhbGYuc2hpZnQoKVxuXG4gICAgICAgICAgICAgICAgLy8gZWRnZSBjYXNlIHdoZXJlIHRoZSBzYW1lIG51bWJlciBpcyBiZWluZyBjb21wYXJlZFxuICAgICAgICAgICAgfSBlbHNlIGlmIChzb3J0ZWRMZWZ0SGFsZlswXSA9PSBzb3J0ZWRSaWdodEhhbGZbMF0pIHtcbiAgICAgICAgICAgICAgICBtZXJnZWRBcnJheS5wdXNoKHNvcnRlZExlZnRIYWxmWzBdKVxuICAgICAgICAgICAgICAgIG1lcmdlZEFycmF5LnB1c2goc29ydGVkUmlnaHRIYWxmWzBdKVxuICAgICAgICAgICAgICAgIHNvcnRlZExlZnRIYWxmLnNoaWZ0KClcbiAgICAgICAgICAgICAgICBzb3J0ZWRSaWdodEhhbGYuc2hpZnQoKVxuICAgICAgICAgICAgICAgIC8vIGVkZ2UgY2FzZSB3aGVyZSBvbmUgYXJyYXkgaXMgZW1wdHlcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIXNvcnRlZExlZnRIYWxmWzBdKSB7XG4gICAgICAgICAgICAgICAgbWVyZ2VkQXJyYXkucHVzaChzb3J0ZWRSaWdodEhhbGZbMF0pXG4gICAgICAgICAgICAgICAgc29ydGVkUmlnaHRIYWxmLnNoaWZ0KClcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIXNvcnRlZFJpZ2h0SGFsZlswXSkge1xuICAgICAgICAgICAgICAgIG1lcmdlZEFycmF5LnB1c2goc29ydGVkTGVmdEhhbGZbMF0pXG4gICAgICAgICAgICAgICAgc29ydGVkTGVmdEhhbGYuc2hpZnQoKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICByZXR1cm4gbWVyZ2VkQXJyYXk7XG4gICAgfVxufSIsIi8vIGltcG9ydCB7IG5vZGUgfSBmcm9tIFwid2VicGFja1wiO1xuaW1wb3J0IHsgbWVyZ2VTb3J0IH0gZnJvbSBcIi4vbWVyZ2VTb3J0XCI7XG5cbmltcG9ydCB7IHByZXR0eVByaW50IH0gZnJvbSBcIi4vcHJldHR5UHJpbnRcIjtcblxuY2xhc3MgTm9kZSB7XG4gICAgY29uc3RydWN0b3IodmFsdWUpIHtcbiAgICAgICAgdGhpcy5kYXRhPSB2YWx1ZTtcbiAgICAgICAgdGhpcy5sZWZ0ID0gbnVsbDtcbiAgICAgICAgdGhpcy5yaWdodCA9IG51bGw7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIFRyZWUge1xuICAgIGNvbnN0cnVjdG9yKGFycmF5KSB7XG4gICAgICAgIHRoaXMucm9vdCA9IGJ1aWxkVHJlZShhcnJheSk7XG4gICAgfVxuXG5cbiAgICBpbnNlcnQodmFsdWUpIHtcbiAgICAgICAgZnVuY3Rpb24gcmVjdXJzaXZlRnVuY3Rpb24obm9kZSwgdmFsdWUpIHtcbiAgICAgICAgICAgIGlmICh2YWx1ZSA8IG5vZGUuZGF0YSAmJiBub2RlLmxlZnQgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG5ld05vZGUgPSBuZXcgTm9kZSh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgbm9kZS5sZWZ0ID0gbmV3Tm9kZTtcblxuICAgICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSA+IG5vZGUuZGF0YSAmJiBub2RlLnJpZ2h0ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdOb2RlID0gbmV3IE5vZGUodmFsdWUpO1xuICAgICAgICAgICAgICAgIG5vZGUucmlnaHQgPSBuZXdOb2RlO1xuXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlIDwgbm9kZS5kYXRhKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlY3Vyc2l2ZUZ1bmN0aW9uKG5vZGUubGVmdCwgdmFsdWUpXG5cbiAgICAgICAgICAgIH0gZWxzZSBpZiAodmFsdWUgPiBub2RlLmRhdGEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVjdXJzaXZlRnVuY3Rpb24obm9kZS5yaWdodCwgdmFsdWUpXG5cbiAgICAgICAgICAgIH0gZWxzZSBpZiAodmFsdWUgPT0gbm9kZS5kYXRhKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJ2YWx1ZSBhbHJlYWR5IGluIHRyZWUsIHRyeSBhbm90aGVyIHZhbHVlXCIpXG4gICAgICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmVjdXJzaXZlRnVuY3Rpb24odGhpcy5yb290LCB2YWx1ZSlcbiAgICB9XG5cbiAgICBkZWxldGUodmFsdWUpIHtcbiAgICAgICAgZnVuY3Rpb24gcmVjdXJzaXZlRnVuY3Rpb24obm9kZSwgdmFsdWUpIHtcbiAgICAgICAgICAgIC8vIHRoaXMgY29kZSByZXF1aXJlcyBndWFyZCBjbGF1c2U6IGlmKG5vZGUubGVmdCksIG9yIGlmKG5vZGUucmlnaHQpXG4gICAgICAgICAgICAvLyBjb25zaWRlciBhdCBsZWFzdCA0IGNhc2VzXG4gICAgICAgICAgICAvLyBDYXNlIDE6IGRlbGV0aW5nIHRoZSBsZWFmIG5vZGVcbiAgICAgICAgICAgIGlmIChub2RlLmxlZnQgJiYgbm9kZS5sZWZ0LmRhdGEgPT09IHZhbHVlICYmIG5vZGUubGVmdC5sZWZ0ID09PSBudWxsICYmIG5vZGUubGVmdC5yaWdodCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIG5vZGUubGVmdCA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChub2RlLnJpZ2h0ICYmIG5vZGUucmlnaHQuZGF0YSA9PT0gdmFsdWUgJiYgbm9kZS5yaWdodC5sZWZ0ID09PSBudWxsICYmIG5vZGUucmlnaHQucmlnaHQgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBub2RlLnJpZ2h0ID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIENhc2UgMjogZGVsZXRpbmcgYSBicmFuY2ggbm9kZSB3aXRoIG9uZSBsZWFmOyBwb2ludCB0aGUgcHJlY2VkaW5nIGNoaWxkIHRvIHRoZSAybmQgZm9sbG93aW5nIGNoaWxkXG4gICAgICAgICAgICBlbHNlIGlmIChub2RlLmxlZnQgJiYgbm9kZS5sZWZ0LmRhdGEgPT09IHZhbHVlICYmIG5vZGUubGVmdC5sZWZ0ICE9PSBudWxsICYmIG5vZGUubGVmdC5sZWZ0LmxlZnQgPT09IG51bGwgXG4gICAgICAgICAgICAgICAgJiYgbm9kZS5sZWZ0LmxlZnQucmlnaHQgPT09IG51bGwgJiYgbm9kZS5sZWZ0LnJpZ2h0ID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGUubGVmdCA9IG5vZGUubGVmdC5sZWZ0XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChub2RlLmxlZnQgJiYgbm9kZS5sZWZ0LmRhdGEgPT09IHZhbHVlICYmIG5vZGUubGVmdC5yaWdodCAhPT0gbnVsbCAmJiBub2RlLmxlZnQucmlnaHQubGVmdCA9PT0gbnVsbCBcbiAgICAgICAgICAgICAgICAmJiBub2RlLmxlZnQucmlnaHQucmlnaHQgPT09IG51bGwgJiYgbm9kZS5sZWZ0LmxlZnQgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZS5sZWZ0ID0gbm9kZS5sZWZ0LnJpZ2h0XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChub2RlLnJpZ2h0ICYmIG5vZGUucmlnaHQuZGF0YSA9PT0gdmFsdWUgJiYgbm9kZS5yaWdodC5sZWZ0ICE9PSBudWxsICYmIG5vZGUucmlnaHQubGVmdC5sZWZ0ID09PSBudWxsIFxuICAgICAgICAgICAgICAgICYmIG5vZGUucmlnaHQubGVmdC5yaWdodCA9PT0gbnVsbCAmJiBub2RlLnJpZ2h0LnJpZ2h0ID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGUucmlnaHQgPSBub2RlLnJpZ2h0LmxlZnRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKG5vZGUucmlnaHQgJiYgbm9kZS5yaWdodC5kYXRhID09PSB2YWx1ZSAmJiBub2RlLnJpZ2h0LnJpZ2h0ICE9PSBudWxsICYmIG5vZGUucmlnaHQucmlnaHQubGVmdCA9PT0gbnVsbCBcbiAgICAgICAgICAgICAgICAmJiBub2RlLnJpZ2h0LnJpZ2h0LnJpZ2h0ID09PSBudWxsICYmIG5vZGUucmlnaHQubGVmdCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBub2RlLnJpZ2h0ID0gbm9kZS5yaWdodC5yaWdodFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gVE9ETzogZWRnZSBjYXNlIHdoZXJlIHJvb3QgaXMgaGFzIG9uZSBsZWFmICh0d28gbm9kZXMgb25seSBpbiB0aGUgdHJlZSlcbiAgICAgICAgICAgIC8vIHJlcXVpcmVzIGNoZWNraW5nIGlmIG5vZGUgaXMgcm9vdCwgYW5kIGNoZWNraW5nIGlmIGl0IG9ubHkgaGFzIG9uZSBsZWFmXG5cbiAgICAgICAgICAgIC8vIENhc2UgMzogZGVsZXRpbmcgYSBicmFuY2ggd2l0aCBib3RoIGxlYXZlczsgZ2V0IHRoZSBuZXh0IHJpZ2h0LCB0aGVuIGxlZnRtb3N0IGkgdGhpbmtcbiAgICAgICAgICAgIGVsc2UgaWYgKG5vZGUuZGF0YSA9PT0gdmFsdWUgJiYgbm9kZS5sZWZ0ICE9PSBudWxsICYmIG5vZGUucmlnaHQgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBsZXQgdGVtcCA9IG5vZGUucmlnaHQ7XG4gICAgICAgICAgICAgICAgbGV0IHRlbXBQYXJlbnQgPSB0ZW1wO1xuICAgICAgICAgICAgICAgIHdoaWxlICh0ZW1wLmxlZnQgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGVtcFBhcmVudCA9IHRlbXA7XG4gICAgICAgICAgICAgICAgICAgIHRlbXAgPSB0ZW1wLmxlZnQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG5vZGUuZGF0YSA9IHRlbXAuZGF0YTtcbiAgICAgICAgICAgICAgICB0ZW1wUGFyZW50LmxlZnQgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gQ2FzZSA0OiBjb25zb2xlIGxvZyBpZiB0aGUgdmFsdWUgaXNuJ3QgZm91bmRcbiAgICAgICAgICAgIGVsc2UgaWYgKHZhbHVlID4gbm9kZS5kYXRhICYmIG5vZGUucmlnaHQgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgJHt2YWx1ZX0gbm90IGZvdW5kLCBwbGVhc2UgdHJ5IGFnYWluYCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgPCBub2RlLmRhdGEgJiYgbm9kZS5sZWZ0ID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coYCR7dmFsdWV9IG5vdCBmb3VuZCwgcGxlYXNlIHRyeSBhZ2FpbmApO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHZhbHVlIDwgbm9kZS5kYXRhKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlY3Vyc2l2ZUZ1bmN0aW9uKG5vZGUubGVmdCwgdmFsdWUpXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCB2YWx1ZSA+IG5vZGUuZGF0YSkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZWN1cnNpdmVGdW5jdGlvbihub2RlLnJpZ2h0LCB2YWx1ZSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZWN1cnNpdmVGdW5jdGlvbih0aGlzLnJvb3QsIHZhbHVlKVxuICAgIH1cblxuICAgIGZpbmQodmFsdWUpIHtcbiAgICAgICAgZnVuY3Rpb24gcmVjdXJzaXZlRnVuY3Rpb24obm9kZSwgdmFsdWUpIHtcbiAgICAgICAgICAgIGlmIChub2RlLmRhdGEgPT09IHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cobm9kZSlcbiAgICAgICAgICAgICAgICByZXR1cm4gbm9kZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZSB2YWx1ZSBleGlzdHMgYXQgbGVhZiBvciB0aGUgbGVhZiBwYXJlbnRzXG4gICAgICAgICAgICBlbHNlIGlmICh2YWx1ZSA+IG5vZGUuZGF0YSAmJiBub2RlLnJpZ2h0ID09PSBudWxsKSBjb25zb2xlLmxvZyhgJHt2YWx1ZX0gbm90IGZvdW5kYClcbiAgICAgICAgICAgIGVsc2UgaWYgKHZhbHVlIDwgbm9kZS5kYXRhICYmIG5vZGUubGVmdCA9PT0gbnVsbCkgY29uc29sZS5sb2coYCR7dmFsdWV9IG5vdCBmb3VuZGApXG4gICAgICAgICAgICAvLyBpZiBub2RlIG5vdCBmb3VuZCwgYW5kIG5vdCBhdCB0aGUgbGVhZiBub2RlcywgcmVjdXJzaXZlbHkgZ28gdGhyb3VnaCB0cmVlXG4gICAgICAgICAgICBlbHNlIGlmICh2YWx1ZSA+IG5vZGUuZGF0YSkgcmV0dXJuIHJlY3Vyc2l2ZUZ1bmN0aW9uKG5vZGUucmlnaHQsIHZhbHVlKVxuICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgPCBub2RlLmRhdGEpIHJldHVybiByZWN1cnNpdmVGdW5jdGlvbihub2RlLmxlZnQsIHZhbHVlKVxuICAgICAgICB9XG4gICAgICAgIHJlY3Vyc2l2ZUZ1bmN0aW9uKHRoaXMucm9vdCwgdmFsdWUpXG4gICAgfVxuXG4gICAgbGV2ZWxPcmRlckl0ZXJhdGl2ZShoZWxwZXJGdW5jdGlvbikge1xuICAgICAgICBsZXQgcXVldWUgPSBbXVxuICAgICAgICBxdWV1ZS5wdXNoKHRoaXMucm9vdClcbiAgICAgICAgaWYgKGhlbHBlckZ1bmN0aW9uKSB7XG4gICAgICAgICAgICB3aGlsZSAocXVldWUubGVuZ3RoICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgaGVscGVyRnVuY3Rpb24ocXVldWVbMF0pXG4gICAgICAgICAgICAgICAgaWYgKHF1ZXVlWzBdLmxlZnQpIHF1ZXVlLnB1c2gocXVldWVbMF0ubGVmdClcbiAgICAgICAgICAgICAgICBpZiAocXVldWVbMF0ucmlnaHQpIHF1ZXVlLnB1c2gocXVldWVbMF0ucmlnaHQpXG4gICAgICAgICAgICAgICAgcXVldWUuc2hpZnQoKVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbGV0IGFycmF5ID0gW11cbiAgICAgICAgICAgIHdoaWxlIChxdWV1ZS5sZW5ndGggIT09IDApIHtcbiAgICAgICAgICAgIGFycmF5LnB1c2gocXVldWVbMF0pO1xuICAgICAgICAgICAgaWYgKHF1ZXVlWzBdLmxlZnQpIHF1ZXVlLnB1c2gocXVldWVbMF0ubGVmdClcbiAgICAgICAgICAgIGlmIChxdWV1ZVswXS5yaWdodCkgcXVldWUucHVzaChxdWV1ZVswXS5yaWdodClcbiAgICAgICAgICAgIHF1ZXVlLnNoaWZ0KClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByZU9yZGVyKGhlbHBlckZ1bmN0aW9uKSB7XG4gICAgICAgIGlmIChoZWxwZXJGdW5jdGlvbikge1xuICAgICAgICAgICAgZnVuY3Rpb24gcmVjdXJzaXZlRnVuY3Rpb24obm9kZSkge1xuICAgICAgICAgICAgICAgIGhlbHBlckZ1bmN0aW9uKG5vZGUpXG4gICAgICAgICAgICAgICAgaWYgKG5vZGUubGVmdCA9PT0gbnVsbCAmJiBub2RlLnJpZ2h0ID09PSBudWxsKSByZXR1cm5cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUubGVmdCkgcmVjdXJzaXZlRnVuY3Rpb24obm9kZS5sZWZ0KVxuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5yaWdodCkgcmVjdXJzaXZlRnVuY3Rpb24obm9kZS5yaWdodClcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZWN1cnNpdmVGdW5jdGlvbih0aGlzLnJvb3QpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBmdW5jdGlvbiByZWN1cnNpdmVGdW5jdGlvbihub2RlKSB7XG4gICAgICAgICAgICAgICAgbGV0IHJlY3Vyc2l2ZVZhbHVlID0gW25vZGUuZGF0YV07XG4gICAgICAgICAgICAgICAgaWYgKG5vZGUubGVmdCA9PT0gbnVsbCAmJiBub2RlLnJpZ2h0ID09PSBudWxsKSByZXR1cm4gW25vZGUuZGF0YV1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUubGVmdCkgcmVjdXJzaXZlVmFsdWUgPSByZWN1cnNpdmVWYWx1ZS5jb25jYXQocmVjdXJzaXZlRnVuY3Rpb24obm9kZS5sZWZ0KSlcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUucmlnaHQpIHJlY3Vyc2l2ZVZhbHVlID0gcmVjdXJzaXZlVmFsdWUuY29uY2F0KHJlY3Vyc2l2ZUZ1bmN0aW9uKG5vZGUucmlnaHQpKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVjdXJzaXZlVmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc29sZS5sb2cocmVjdXJzaXZlRnVuY3Rpb24odGhpcy5yb290KSlcblxuICAgICAgICAgICAgLy8gY2xlYW5lciB2ZXJzaW9uOyBiYXNlIGNhc2UgaXMgbm90IHN0YXRlZCwgYXMgZG8gbm90IG5lZWQgdG8gc3RhdGUgaWYgbnVsbFxuICAgICAgICAgICAgLy8gZnVuY3Rpb24gcmVjdXJzaXZlVHJhdmVyc2FsKG5vZGUpIHtcbiAgICAgICAgICAgIC8vIGxldCBhcnJheSA9IFtub2RlLmRhdGFdICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBpZiAobm9kZS5sZWZ0KSBhcnJheSA9IGFycmF5LmNvbmNhdChyZWN1cnNpdmVUcmF2ZXJzYWwobm9kZS5sZWZ0KSkgLy8gXCJjb25uZWN0aW5nXCIgYXJyYXlzXG4gICAgICAgICAgICAvLyBpZiAobm9kZS5yaWdodCkgYXJyYXkgPSBhcnJheS5jb25jYXQocmVjdXJzaXZlVHJhdmVyc2FsKG5vZGUucmlnaHQpKSAvLyBcImNvbm5lY3RpbmdcIiBhcnJheXNcbiAgICAgICAgICAgIC8vIHJldHVybiBhcnJheVxuICAgICAgICAgICAgLy8gfVxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocmVjdXJzaXZlVHJhdmVyc2FsKHRoaXMucm9vdCkpXG4gICAgICAgICAgICAvLyB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyB0cmF2ZXJzZSB0aGUgbGVmdCBzdWJ0cmVlLCB0aGVuIHRoZSByb290LCB0aGVuIHRoZSByaWdodCBzdWJ0cmVlLlxuICAgIGluT3JkZXIoaGVscGVyRnVuY3Rpb24pIHtcbiAgICAgICAgaWYgKGhlbHBlckZ1bmN0aW9uKSB7XG4gICAgICAgICAgICBmdW5jdGlvbiByZWN1cnNpdmVGdW5jdGlvbihub2RlKSB7XG4gICAgICAgICAgICAgICAgaWYgKG5vZGUubGVmdCA9PT0gbnVsbCAmJiBub2RlLnJpZ2h0ID09PSBudWxsKSBoZWxwZXJGdW5jdGlvbihub2RlKVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5sZWZ0KSByZWN1cnNpdmVGdW5jdGlvbihub2RlLmxlZnQpXG4gICAgICAgICAgICAgICAgICAgIGhlbHBlckZ1bmN0aW9uKG5vZGUpXG4gICAgICAgICAgICAgICAgICAgIGlmIChub2RlLnJpZ2h0KSByZWN1cnNpdmVGdW5jdGlvbihub2RlLnJpZ2h0KVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlY3Vyc2l2ZUZ1bmN0aW9uKHRoaXMucm9vdClcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGZ1bmN0aW9uIHJlY3Vyc2l2ZUZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgICAgICAgICAgICBsZXQgcmVjdXJzaXZlVmFsdWUgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUubGVmdCkgcmVjdXJzaXZlVmFsdWUgPSByZWN1cnNpdmVWYWx1ZS5jb25jYXQocmVjdXJzaXZlRnVuY3Rpb24obm9kZS5sZWZ0KSlcbiAgICAgICAgICAgICAgICAgICAgcmVjdXJzaXZlVmFsdWUgPSByZWN1cnNpdmVWYWx1ZS5jb25jYXQoW25vZGUuZGF0YV0pXG4gICAgICAgICAgICAgICAgICAgIGlmIChub2RlLnJpZ2h0KSByZWN1cnNpdmVWYWx1ZSA9IHJlY3Vyc2l2ZVZhbHVlLmNvbmNhdChyZWN1cnNpdmVGdW5jdGlvbihub2RlLnJpZ2h0KSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlY3Vyc2l2ZVZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc29sZS5sb2cocmVjdXJzaXZlRnVuY3Rpb24odGhpcy5yb290KSlcbiAgICAgICAgfVxuICAgIH1cblxuXG5cbiAgICAvLyB0cmF2ZXJzZSB0aGUgbGVmdCBzdWJ0cmVlLCB0aGVuIHRoZSByaWdodCBzdWJ0cmVlLCB0aGVuIHRoZSByb290LlxuICAgIHBvc3RPcmRlcihoZWxwZXJGdW5jdGlvbikge1xuICAgICAgICBpZiAoaGVscGVyRnVuY3Rpb24pIHtcbiAgICAgICAgICAgIGZ1bmN0aW9uIHJlY3Vyc2l2ZUZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgICAgICAgICAgICBpZiAobm9kZS5sZWZ0ID09PSBudWxsICYmIG5vZGUucmlnaHQgPT09IG51bGwpIGhlbHBlckZ1bmN0aW9uKG5vZGUpXG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChub2RlLmxlZnQpIHJlY3Vyc2l2ZUZ1bmN0aW9uKG5vZGUubGVmdClcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUucmlnaHQpIHJlY3Vyc2l2ZUZ1bmN0aW9uKG5vZGUucmlnaHQpXG4gICAgICAgICAgICAgICAgICAgIGhlbHBlckZ1bmN0aW9uKG5vZGUpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmVjdXJzaXZlRnVuY3Rpb24odGhpcy5yb290KVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZnVuY3Rpb24gcmVjdXJzaXZlRnVuY3Rpb24obm9kZSkge1xuICAgICAgICAgICAgICAgIGxldCByZWN1cnNpdmVWYWx1ZSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5sZWZ0KSByZWN1cnNpdmVWYWx1ZSA9IHJlY3Vyc2l2ZVZhbHVlLmNvbmNhdChyZWN1cnNpdmVGdW5jdGlvbihub2RlLmxlZnQpKVxuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5yaWdodCkgcmVjdXJzaXZlVmFsdWUgPSByZWN1cnNpdmVWYWx1ZS5jb25jYXQocmVjdXJzaXZlRnVuY3Rpb24obm9kZS5yaWdodCkpXG4gICAgICAgICAgICAgICAgICAgIHJlY3Vyc2l2ZVZhbHVlID0gcmVjdXJzaXZlVmFsdWUuY29uY2F0KFtub2RlLmRhdGFdKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVjdXJzaXZlVmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhyZWN1cnNpdmVGdW5jdGlvbih0aGlzLnJvb3QpKVxuICAgICAgICB9XG4gICAgfVxuXG5cbiAgICAvLyBoZWlnaHQ7IGZpbmQgbG9uZ2VzdCBsZW5ndGggYmV0d2VlbiB0aGlzIG5vZGUsIGFuZCBsZWFmIG5vZGUuIGhvdz8gZG8gaSBuZWVkIHRvIHVzZSBmaW5kP1xuICAgIGhlaWdodCh2YWx1ZSkge1xuICAgICAgICBmdW5jdGlvbiByZWN1cnNpdmVGaW5kKG5vZGUsIHZhbHVlKSB7XG4gICAgICAgICAgICBpZiAobm9kZS5kYXRhID09PSB2YWx1ZSkgcmV0dXJuIG5vZGVcbiAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZSB2YWx1ZSBleGlzdHMgYXQgbGVhZiBvciB0aGUgbGVhZiBwYXJlbnRzXG4gICAgICAgICAgICBlbHNlIGlmICh2YWx1ZSA+IG5vZGUuZGF0YSAmJiBub2RlLnJpZ2h0ID09PSBudWxsKSByZXR1cm5cbiAgICAgICAgICAgIGVsc2UgaWYgKHZhbHVlIDwgbm9kZS5kYXRhICYmIG5vZGUubGVmdCA9PT0gbnVsbCkgcmV0dXJuXG4gICAgICAgICAgICBlbHNlIGlmICh2YWx1ZSA+IG5vZGUuZGF0YSkgcmV0dXJuIHJlY3Vyc2l2ZUZpbmQobm9kZS5yaWdodCwgdmFsdWUpXG4gICAgICAgICAgICBlbHNlIGlmICh2YWx1ZSA8IG5vZGUuZGF0YSkgcmV0dXJuIHJlY3Vyc2l2ZUZpbmQobm9kZS5sZWZ0LCB2YWx1ZSlcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHRoaXMgT05MWSB3b3JrcyBvbiBhIGJhbGFuY2VkIHRyZWUsIG5vdCBvbiBhIHVuYmFsYW5jZWQgdHJlZS5cbiAgICAgICAgLy8gcmVjdXJzaXZlbHkgdHJhdmVyc2UgdGhlIGxlZnQgc3VidHJlZSBhbmQgZmluZCB0aGUgaGVpZ2h0LCBcbiAgICAgICAgLy8gVEhFTiByZWN1cnNpdmVseSB0cmF2ZXJzZSB0aGUgcmlnaHQgc3VidHJlZSBhbmQgZmluZCB0aGUgaGVpZ2h0XG4gICAgICAgIC8vIHRoZW4gcmV0dXJuIHRoZSBncmVhdGVyIG9mIHRoZSB0d28gaGVpZ2h0c1xuICAgICAgICAvLyByZXR1cm4gZXJyb3IgbWVzc2FnZSBpZiB2YWx1ZSBpcyBub3QgZm91bmRcbiAgICAgICAgZnVuY3Rpb24gcmVjdXJzaXZlVHJhdmVyc2FsTGVmdChub2RlLCBjb3VudGVyKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvdW50ZXIgPSAwO1xuICAgICAgICAgICAgICAgIGlmIChub2RlLmxlZnQpIGNvdW50ZXIgKz0gcmVjdXJzaXZlVHJhdmVyc2FsTGVmdChub2RlLmxlZnQsIGNvdW50ZXIpKzE7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvdW50ZXI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaChlcnIpIHtyZXR1cm4gJ3ZhbHVlIG5vdCBmb3VuZCd9XG5cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiByZWN1cnNpdmVUcmF2ZXJzYWxSaWdodChub2RlLCBjb3VudGVyKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvdW50ZXIgPSAwO1xuICAgICAgICAgICAgICAgIGlmIChub2RlLnJpZ2h0KSBjb3VudGVyICs9IHJlY3Vyc2l2ZVRyYXZlcnNhbFJpZ2h0KG5vZGUucmlnaHQsIGNvdW50ZXIpKzE7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvdW50ZXI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaChlcnIpIHtyZXR1cm4gJ3ZhbHVlIG5vdCBmb3VuZCd9XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgbGVmdENvdW50ZXIgPSByZWN1cnNpdmVUcmF2ZXJzYWxMZWZ0KHJlY3Vyc2l2ZUZpbmQodGhpcy5yb290LCB2YWx1ZSkpXG4gICAgICAgIGNvbnN0IHJpZ2h0Q291bnRlciA9IHJlY3Vyc2l2ZVRyYXZlcnNhbFJpZ2h0KHJlY3Vyc2l2ZUZpbmQodGhpcy5yb290LCB2YWx1ZSkpXG4gICAgICAgIGlmIChsZWZ0Q291bnRlciA+IHJpZ2h0Q291bnRlcikgcmV0dXJuIGxlZnRDb3VudGVyXG4gICAgICAgIGVsc2UgaWYgKHJpZ2h0Q291bnRlciA+IGxlZnRDb3VudGVyKSByZXR1cm4gcmlnaHRDb3VudGVyXG4gICAgICAgIGVsc2UgcmV0dXJuIGxlZnRDb3VudGVyXG4gICAgfVxuXG4gICAgaGVpZ2h0Mih2YWx1ZSkge1xuICAgICAgICBmdW5jdGlvbiByZWN1cnNpdmVGaW5kKG5vZGUsIHZhbHVlKSB7XG4gICAgICAgICAgICBpZiAobm9kZS5kYXRhID09PSB2YWx1ZSkgcmV0dXJuIG5vZGU7XG4gICAgICAgICAgICAvLyBjaGVjayBpZiB0aGUgdmFsdWUgZXhpc3RzIGF0IGxlYWYgb3IgdGhlIGxlYWYgcGFyZW50c1xuICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgPiBub2RlLmRhdGEgJiYgbm9kZS5yaWdodCA9PT0gbnVsbCkgcmV0dXJuXG4gICAgICAgICAgICBlbHNlIGlmICh2YWx1ZSA8IG5vZGUuZGF0YSAmJiBub2RlLmxlZnQgPT09IG51bGwpIHJldHVyblxuICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgPiBub2RlLmRhdGEpIHJldHVybiByZWN1cnNpdmVGaW5kKG5vZGUucmlnaHQsIHZhbHVlKVxuICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgPCBub2RlLmRhdGEpIHJldHVybiByZWN1cnNpdmVGaW5kKG5vZGUubGVmdCwgdmFsdWUpXG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiByZWN1cnNpdmVUcmF2ZXJzYWwobm9kZSwgY291bnRlciA9IDAsIGhlaWdodHMgPSBbXSkge1xuICAgICAgICAgICAgaWYgKG5vZGUubGVmdCA9PSBudWxsICYmIG5vZGUucmlnaHQgPT0gbnVsbCkgaGVpZ2h0cy5wdXNoKGNvdW50ZXIpXG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAobm9kZS5sZWZ0KSByZWN1cnNpdmVUcmF2ZXJzYWwobm9kZS5sZWZ0LCBjb3VudGVyKzEsIGhlaWdodHMpXG4gICAgICAgICAgICAgICAgaWYgKG5vZGUucmlnaHQpIHJlY3Vyc2l2ZVRyYXZlcnNhbChub2RlLnJpZ2h0LCBjb3VudGVyKzEsIGhlaWdodHMpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gTWF0aC5tYXgoLi4uaGVpZ2h0cylcbiAgICAgICAgICAgIFxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZWN1cnNpdmVUcmF2ZXJzYWwocmVjdXJzaXZlRmluZCh0aGlzLnJvb3QsIHZhbHVlKSlcbiAgICB9XG5cbiAgICAvLyBzdWJ0cmFjdCBub2RlSGVpZ2h0IGZyb20gcm9vdEhlaWdodCB0byBvYnRhaW4gbm9kZURlcHRoXG4gICAgZGVwdGgodmFsdWUpIHtcbiAgICAgICAgY29uc3Qgcm9vdEhlaWdodCA9IHRoaXMuaGVpZ2h0KHRoaXMucm9vdC5kYXRhKVxuICAgICAgICBjb25zdCBub2RlSGVpZ2h0ID0gdGhpcy5oZWlnaHQodmFsdWUpXG4gICAgICAgIGNvbnN0IG5vZGVEZXB0aCA9IHJvb3RIZWlnaHQgLSBub2RlSGVpZ2h0O1xuICAgICAgICByZXR1cm4gbm9kZURlcHRoXG4gICAgfVxuXG4gICAgLy8gaSdtIHN1cmUgdGhpcyBpc24ndCBhcyBjb21wbGljYXRlZCBhcyBpIHRoaW5rLi4uXG4gICAgLy8gY29tcGFyZSBoZWlnaHQgb2YgbGVmdCBzdWJ0cmVlLCBhbmQgaGVpZ2h0IHJpZ2h0IHN1YnRyZWUuLi4gbWF5IG5lZWQgdG8gdXNlIHJlY3Vyc2l2ZUxlZnQgYW5kIHJlY3Vyc2l2ZVJpZ2h0Li4uXG4gICAgLy8gbWF5IG5lZWQgdG8gcmVjdXJzaXZlbHkgZ28gdGhyb3VnaCBlYWNoIG5vZGUgdGhvdWdoXG4gICAgaXNCYWxhbmNlZCgpIHtcbiAgICAgICAgY29uc3QgbGVmdFN1YnRyZWVIZWlnaHQgPSB0aGlzLmhlaWdodCh0aGlzLnJvb3QubGVmdC5kYXRhKVxuICAgICAgICBjb25zb2xlLmxvZyhsZWZ0U3VidHJlZUhlaWdodClcbiAgICAgICAgY29uc3QgcmlnaHRTdWJ0cmVlSGVpZ2h0ID0gdGhpcy5oZWlnaHQodGhpcy5yb290LnJpZ2h0LmRhdGEpXG4gICAgICAgIGNvbnNvbGUubG9nKHJpZ2h0U3VidHJlZUhlaWdodClcbiAgICAgICAgY29uc3QgaGVpZ2h0RGlmZiA9IE1hdGguYWJzKGxlZnRTdWJ0cmVlSGVpZ2h0IC0gcmlnaHRTdWJ0cmVlSGVpZ2h0KVxuICAgICAgICBjb25zb2xlLmxvZyhoZWlnaHREaWZmKVxuICAgICAgICBpZiAoaGVpZ2h0RGlmZiA9PT0gMCB8fCBoZWlnaHREaWZmID09PSAxKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cblxuICAgIC8vIGkgdGhpbmsgdGhpcyBpcyBzaW1wbHkgdXNpbmcgbGV2ZWxPcmRlciBoZWhcbiAgICByZWJhbGFuY2UoKSB7XG4gICAgICAgIFxuICAgIH1cblxuXG59XG5cblxuXG5leHBvcnQgZnVuY3Rpb24gYnVpbGRUcmVlKGFycmF5KSB7XG4gICAgICAgIGxldCBzb3J0ZWRBcnJheSA9IG1lcmdlU29ydChhcnJheSlcbiAgICAgICAgbGV0IHJlbW92ZWREdXBsaWNhdGVzID0gWy4uLiBuZXcgU2V0KHNvcnRlZEFycmF5KV1cbiAgICAgICAgcmV0dXJuIHJlY3Vyc2l2ZUJ1aWxkVHJlZShyZW1vdmVkRHVwbGljYXRlcylcbn1cblxuZnVuY3Rpb24gcmVjdXJzaXZlQnVpbGRUcmVlKGFycmF5KSB7XG4gICAgaWYgKGFycmF5Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgICByZXR1cm4gbnVsbDsgLy8gd2hhdCBkbyBpIG5lZWQgdG8gcmV0dXJuPyBhcnJheT8gbm9kZT9cbiAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBtaWRkbGVJbmRleCA9IE1hdGguZmxvb3IoYXJyYXkubGVuZ3RoLzIpXG4gICAgICAgIGNvbnN0IHJvb3QgPSBuZXcgTm9kZShhcnJheVttaWRkbGVJbmRleF0pXG5cbiAgICAgICAgcm9vdC5sZWZ0ID0gcmVjdXJzaXZlQnVpbGRUcmVlKGFycmF5LnNsaWNlKDAsIG1pZGRsZUluZGV4KSlcbiAgICAgICAgcm9vdC5yaWdodCA9IHJlY3Vyc2l2ZUJ1aWxkVHJlZShhcnJheS5zbGljZShtaWRkbGVJbmRleCArIDEpKVxuICAgICAgICByZXR1cm4gcm9vdDtcbiAgICB9XG59XG5cbiIsImV4cG9ydCBjb25zdCBwcmV0dHlQcmludCA9IChub2RlLCBwcmVmaXggPSBcIlwiLCBpc0xlZnQgPSB0cnVlKSA9PiB7XG4gIGlmIChub2RlID09PSBudWxsKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGlmIChub2RlLnJpZ2h0ICE9PSBudWxsKSB7XG4gICAgcHJldHR5UHJpbnQobm9kZS5yaWdodCwgYCR7cHJlZml4fSR7aXNMZWZ0ID8gXCLilIIgICBcIiA6IFwiICAgIFwifWAsIGZhbHNlKTtcbiAgfVxuICBjb25zb2xlLmxvZyhgJHtwcmVmaXh9JHtpc0xlZnQgPyBcIuKUlOKUgOKUgCBcIiA6IFwi4pSM4pSA4pSAIFwifSR7bm9kZS5kYXRhfWApO1xuICBpZiAobm9kZS5sZWZ0ICE9PSBudWxsKSB7XG4gICAgcHJldHR5UHJpbnQobm9kZS5sZWZ0LCBgJHtwcmVmaXh9JHtpc0xlZnQgPyBcIiAgICBcIiA6IFwi4pSCICAgXCJ9YCwgdHJ1ZSk7XG4gIH1cbn07IiwiaW1wb3J0IHsgVHJlZSB9IGZyb20gXCIuL0JTVFwiO1xuaW1wb3J0IHsgYnVpbGRUcmVlIH0gZnJvbSBcIi4vQlNUXCI7XG5pbXBvcnQgeyBwcmV0dHlQcmludCB9IGZyb20gXCIuL3ByZXR0eVByaW50XCI7XG5cbmNvbnN0IHRlc3RBcnJheSA9IFsxLCA3LCA0LCAyMywgOCwgOSwgNCwgMywgNSwgNywgOSwgNjcsIDYzNDUsIDMyNF1cblxuY29uc29sZS5sb2codGVzdEFycmF5KVxuXG4vLyBidWlsZFRyZWUodGVzdEFycmF5KVxubGV0IG5ld1RyZWUgPSBuZXcgVHJlZSh0ZXN0QXJyYXkpXG5jb25zb2xlLmxvZyhuZXdUcmVlKVxucHJldHR5UHJpbnQobmV3VHJlZS5yb290KVxuXG5uZXdUcmVlLmluc2VydCg5KVxucHJldHR5UHJpbnQobmV3VHJlZS5yb290KVxuXG5uZXdUcmVlLmRlbGV0ZSgzMjMpXG5wcmV0dHlQcmludChuZXdUcmVlLnJvb3QpXG5cbm5ld1RyZWUuZmluZCg2KVxubmV3VHJlZS5maW5kKDEpXG5uZXdUcmVlLmZpbmQoNSlcblxuLy8gbmV3VHJlZS5sZXZlbE9yZGVySXRlcmF0aXZlKChub2RlKSA9PiBjb25zb2xlLmxvZyhub2RlKSlcblxubmV3VHJlZS5sZXZlbE9yZGVySXRlcmF0aXZlKCk7XG5uZXdUcmVlLnByZU9yZGVyKClcblxuLy8gbmV3VHJlZS5wcmVPcmRlcigobm9kZSk9PiBjb25zb2xlLmxvZyhub2RlLmRhdGEpKVxuXG4vLyBuZXdUcmVlLmluT3JkZXIoKG5vZGUpPT5jb25zb2xlLmxvZyhub2RlLmRhdGEpKVxuXG5uZXdUcmVlLnBvc3RPcmRlcigpXG5cbi8vIGNvbnNvbGUubG9nKFxuLy8gICAgIG5ld1RyZWUuaGVpZ2h0KDUwKVxuLy8gKVxuXG5jb25zb2xlLmxvZyhcbiAgICBuZXdUcmVlLmhlaWdodDIoNjM0NSlcbilcblxuXG4vLyBjb25zb2xlLmxvZyhcbi8vICAgICBuZXdUcmVlLmRlcHRoKDUpXG4vLyApXG5cbi8vIGNvbnNvbGUubG9nKFxuLy8gICAgIG5ld1RyZWUuaXNCYWxhbmNlZCgpXG4vLyApXG5cbm5ld1RyZWUuaW5zZXJ0KDk5OSlcbm5ld1RyZWUuaW5zZXJ0KDMyMilcbm5ld1RyZWUuaW5zZXJ0KDMyMSlcbm5ld1RyZWUuaW5zZXJ0KDMyMClcbm5ld1RyZWUuaW5zZXJ0KDApXG5wcmV0dHlQcmludChuZXdUcmVlLnJvb3QpXG5jb25zb2xlLmxvZyhcbiAgICBuZXdUcmVlLmhlaWdodDIoMzI0KVxuKVxuLy8gY29uc29sZS5sb2coXG4vLyAgICAgbmV3VHJlZS5pc0JhbGFuY2VkKClcbi8vICkiXSwibmFtZXMiOlsibWVyZ2VTb3J0IiwiYXJyYXkiLCJsZW5ndGgiLCJoYWxmIiwiTWF0aCIsImNlaWwiLCJzb3J0ZWRMZWZ0SGFsZiIsInNsaWNlIiwic29ydGVkUmlnaHRIYWxmIiwibWVyZ2VkQXJyYXkiLCJwdXNoIiwic2hpZnQiLCJOb2RlIiwiY29uc3RydWN0b3IiLCJ2YWx1ZSIsInRoaXMiLCJkYXRhIiwibGVmdCIsInJpZ2h0IiwicmVjdXJzaXZlQnVpbGRUcmVlIiwibWlkZGxlSW5kZXgiLCJmbG9vciIsInJvb3QiLCJwcmV0dHlQcmludCIsIm5vZGUiLCJwcmVmaXgiLCJpc0xlZnQiLCJjb25zb2xlIiwibG9nIiwidGVzdEFycmF5IiwibmV3VHJlZSIsInNvcnRlZEFycmF5IiwiU2V0IiwiYnVpbGRUcmVlIiwiaW5zZXJ0IiwicmVjdXJzaXZlRnVuY3Rpb24iLCJuZXdOb2RlIiwidGVtcCIsInRlbXBQYXJlbnQiLCJmaW5kIiwibGV2ZWxPcmRlckl0ZXJhdGl2ZSIsImhlbHBlckZ1bmN0aW9uIiwicXVldWUiLCJwcmVPcmRlciIsInJlY3Vyc2l2ZVZhbHVlIiwiY29uY2F0IiwiaW5PcmRlciIsInBvc3RPcmRlciIsImhlaWdodCIsInJlY3Vyc2l2ZUZpbmQiLCJsZWZ0Q291bnRlciIsInJlY3Vyc2l2ZVRyYXZlcnNhbExlZnQiLCJjb3VudGVyIiwiZXJyIiwicmlnaHRDb3VudGVyIiwicmVjdXJzaXZlVHJhdmVyc2FsUmlnaHQiLCJoZWlnaHQyIiwicmVjdXJzaXZlVHJhdmVyc2FsIiwiaGVpZ2h0cyIsIm1heCIsImRlcHRoIiwiaXNCYWxhbmNlZCIsImxlZnRTdWJ0cmVlSGVpZ2h0IiwicmlnaHRTdWJ0cmVlSGVpZ2h0IiwiaGVpZ2h0RGlmZiIsImFicyIsInJlYmFsYW5jZSIsImRlbGV0ZSJdLCJzb3VyY2VSb290IjoiIn0=